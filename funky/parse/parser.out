Created by PLY version 3.11 (http://www.dabeaz.com/ply)

Unused terminals:

    AS
    CLOSE_SQUARE
    COMMA
    NEWTYPE
    OPEN_SQUARE
    WHITESPACE

Grammar

Rule 0     S' -> FIXITY_DECLARATION
Rule 1     MODULE_DEFINITION -> MODULE IDENTIFIER WHERE BODY
Rule 2     BODY -> OPEN_BRACE IMPORT_DECLARATIONS ENDSTATEMENT TOP_DECLARATIONS CLOSE_BRACE
Rule 3     BODY -> OPEN_BRACE TOP_DECLARATIONS CLOSE_BRACE
Rule 4     IMPORT_DECLARATIONS -> IMPORT_DECLARATIONS ENDSTATEMENT IMPORT_DECLARATION
Rule 5     IMPORT_DECLARATIONS -> IMPORT_DECLARATION
Rule 6     IMPORT_DECLARATION -> IMPORT IDENTIFIER
Rule 7     TOP_DECLARATIONS -> TOP_DECLARATIONS ENDSTATEMENT TOP_DECLARATION
Rule 8     TOP_DECLARATIONS -> TOP_DECLARATION
Rule 9     TOP_DECLARATION -> NEW_CONS
Rule 10    TOP_DECLARATION -> DECLARATION
Rule 11    NEW_CONS -> NEWCONS TYPENAME EQUALS CONSTRUCTORS
Rule 12    CONSTRUCTORS -> CONSTRUCTORS PIPE CONSTRUCTOR
Rule 13    CONSTRUCTORS -> CONSTRUCTOR
Rule 14    CONSTRUCTOR -> TYPENAME ATYPES
Rule 15    DECLARATIONS -> OPEN_BRACE DECLARATIONS_LIST CLOSE_BRACE
Rule 16    DECLARATIONS -> OPEN_BRACE CLOSE_BRACE
Rule 17    DECLARATIONS_LIST -> DECLARATION ENDSTATEMENT DECLARATIONS_LIST
Rule 18    DECLARATIONS_LIST -> DECLARATION
Rule 19    DECLARATION -> GEN_DECLARATION
Rule 20    DECLARATION -> FUNCTION_LHS RHS
Rule 21    DECLARATION -> LPAT RHS
Rule 22    GEN_DECLARATION -> IDENTIFIER TYPESIG TYPE
Rule 23    GEN_DECLARATION -> FIXITY_DECLARATION
Rule 24    GEN_DECLARATION -> <empty>
Rule 25    FIXITY_DECLARATION -> SETFIX ASSOCIATIVITY INTEGER OP
Rule 26    ASSOCIATIVITY -> LEFTASSOC
Rule 27    ASSOCIATIVITY -> RIGHTASSOC
Rule 28    ASSOCIATIVITY -> NONASSOC
Rule 29    TYPE -> ATYPE
Rule 30    TYPE -> ATYPE ARROW TYPE
Rule 31    ATYPES -> ATYPES ATYPE
Rule 32    ATYPES -> <empty>
Rule 33    ATYPE -> TYPENAME
Rule 34    ATYPE -> OPEN_PAREN TYPE CLOSE_PAREN
Rule 35    FUNCTION_LHS -> IDENTIFIER APAT APATS
Rule 36    FUNCTION_LHS -> LPAT VAROP LPAT
Rule 37    FUNCTION_LHS -> OPEN_PAREN FUNCTION_LHS CLOSE_PAREN APAT APATS
Rule 38    RHS -> EQUALS EXP
Rule 39    RHS -> EQUALS EXP WHERE DECLARATIONS
Rule 40    RHS -> GDRHS
Rule 41    RHS -> GDRHS WHERE DECLARATIONS
Rule 42    GDRHS -> PIPE EXP EQUALS EXP
Rule 43    GDRHS -> PIPE EXP EQUALS EXP GDRHS
Rule 44    EXP -> INFIX_EXP
Rule 45    INFIX_EXP -> LEXP OP INFIX_EXP
Rule 46    INFIX_EXP -> MINUS INFIX_EXP
Rule 47    INFIX_EXP -> LEXP
Rule 48    LEXP -> LAMBDA APAT APATS ARROW EXP
Rule 49    LEXP -> LET DECLARATIONS IN EXP
Rule 50    LEXP -> IF EXP THEN EXP ELSE EXP
Rule 51    LEXP -> MATCH EXP OF OPEN_BRACE ALTS CLOSE_BRACE
Rule 52    LEXP -> FEXP
Rule 53    FEXP -> FEXP AEXP
Rule 54    FEXP -> AEXP
Rule 55    AEXP -> USED_VAR
Rule 56    AEXP -> TYPENAME
Rule 57    AEXP -> LITERAL
Rule 58    AEXP -> OPEN_PAREN EXP CLOSE_PAREN
Rule 59    CONSTRUCTION_PARAMS -> CONSTRUCTION_PARAMS AEXP
Rule 60    CONSTRUCTION_PARAMS -> AEXP
Rule 61    ALTS -> ALT ENDSTATEMENT ALTS
Rule 62    ALTS -> ALT
Rule 63    ALT -> LPAT ARROW EXP
Rule 64    ALT -> <empty>
Rule 65    LPAT -> APAT
Rule 66    LPAT -> MINUS OPEN_PAREN INTEGER CLOSE_PAREN
Rule 67    LPAT -> MINUS OPEN_PAREN FLOAT CLOSE_PAREN
Rule 68    LPAT -> TYPENAME APAT APATS
Rule 69    APAT -> PARAM
Rule 70    APAT -> TYPENAME
Rule 71    APAT -> LITERAL
Rule 72    APAT -> OPEN_PAREN LPAT CLOSE_PAREN
Rule 73    VAROP -> VARSYM
Rule 74    VAROP -> BACKTICK IDENTIFIER BACKTICK
Rule 75    OP -> VAROP
Rule 76    APATS -> APAT APATS
Rule 77    APATS -> <empty>
Rule 78    VARSYM -> PLUS
Rule 79    VARSYM -> MINUS
Rule 80    VARSYM -> TIMES
Rule 81    VARSYM -> DIVIDE
Rule 82    VARSYM -> MODULO
Rule 83    VARSYM -> POW
Rule 84    VARSYM -> EQUALITY
Rule 85    VARSYM -> INEQUALITY
Rule 86    VARSYM -> LESS
Rule 87    VARSYM -> LEQ
Rule 88    VARSYM -> GREATER
Rule 89    VARSYM -> GEQ
Rule 90    VARSYM -> AND
Rule 91    VARSYM -> OR
Rule 92    VARSYM -> LIST_CONSTRUCTOR
Rule 93    LITERAL -> FLOAT
Rule 94    LITERAL -> INTEGER
Rule 95    LITERAL -> BOOL
Rule 96    LITERAL -> CHAR
Rule 97    LITERAL -> STRING
Rule 98    USED_VAR -> IDENTIFIER
Rule 99    PARAM -> IDENTIFIER

Terminals, with rules where they appear

AND                  : 90
ARROW                : 30 48 63
AS                   : 
BACKTICK             : 74 74
BOOL                 : 95
CHAR                 : 96
CLOSE_BRACE          : 2 3 15 16 51
CLOSE_PAREN          : 34 37 58 66 67 72
CLOSE_SQUARE         : 
COMMA                : 
DIVIDE               : 81
ELSE                 : 50
ENDSTATEMENT         : 2 4 7 17 61
EQUALITY             : 84
EQUALS               : 11 38 39 42 43
FLOAT                : 67 93
GEQ                  : 89
GREATER              : 88
IDENTIFIER           : 1 6 22 35 74 98 99
IF                   : 50
IMPORT               : 6
IN                   : 49
INEQUALITY           : 85
INTEGER              : 25 66 94
LAMBDA               : 48
LEFTASSOC            : 26
LEQ                  : 87
LESS                 : 86
LET                  : 49
LIST_CONSTRUCTOR     : 92
MATCH                : 51
MINUS                : 46 66 67 79
MODULE               : 1
MODULO               : 82
NEWCONS              : 11
NEWTYPE              : 
NONASSOC             : 28
OF                   : 51
OPEN_BRACE           : 2 3 15 16 51
OPEN_PAREN           : 34 37 58 66 67 72
OPEN_SQUARE          : 
OR                   : 91
PIPE                 : 12 42 43
PLUS                 : 78
POW                  : 83
RIGHTASSOC           : 27
SETFIX               : 25
STRING               : 97
THEN                 : 50
TIMES                : 80
TYPENAME             : 11 14 33 56 68 70
TYPESIG              : 22
WHERE                : 1 39 41
WHITESPACE           : 
error                : 

Nonterminals, with rules where they appear

AEXP                 : 53 54 59 60
ALT                  : 61 62
ALTS                 : 51 61
APAT                 : 35 37 48 65 68 76
APATS                : 35 37 48 68 76
ASSOCIATIVITY        : 25
ATYPE                : 29 30 31
ATYPES               : 14 31
BODY                 : 1
CONSTRUCTION_PARAMS  : 59
CONSTRUCTOR          : 12 13
CONSTRUCTORS         : 11 12
DECLARATION          : 10 17 18
DECLARATIONS         : 39 41 49
DECLARATIONS_LIST    : 15 17
EXP                  : 38 39 42 42 43 43 48 49 50 50 50 51 58 63
FEXP                 : 52 53
FIXITY_DECLARATION   : 23 0
FUNCTION_LHS         : 20 37
GDRHS                : 40 41 43
GEN_DECLARATION      : 19
IMPORT_DECLARATION   : 4 5
IMPORT_DECLARATIONS  : 2 4
INFIX_EXP            : 44 45 46
LEXP                 : 45 47
LITERAL              : 57 71
LPAT                 : 21 36 36 63 72
MODULE_DEFINITION    : 
NEW_CONS             : 9
OP                   : 25 45
PARAM                : 69
RHS                  : 20 21
TOP_DECLARATION      : 7 8
TOP_DECLARATIONS     : 2 3 7
TYPE                 : 22 30 34
USED_VAR             : 55
VAROP                : 36 75
VARSYM               : 73

Parsing method: LALR

state 0

    (0) S' -> . FIXITY_DECLARATION
    (25) FIXITY_DECLARATION -> . SETFIX ASSOCIATIVITY INTEGER OP

    SETFIX          shift and go to state 2

    FIXITY_DECLARATION             shift and go to state 1

state 1

    (0) S' -> FIXITY_DECLARATION .



state 2

    (25) FIXITY_DECLARATION -> SETFIX . ASSOCIATIVITY INTEGER OP
    (26) ASSOCIATIVITY -> . LEFTASSOC
    (27) ASSOCIATIVITY -> . RIGHTASSOC
    (28) ASSOCIATIVITY -> . NONASSOC

    LEFTASSOC       shift and go to state 4
    RIGHTASSOC      shift and go to state 5
    NONASSOC        shift and go to state 6

    ASSOCIATIVITY                  shift and go to state 3

state 3

    (25) FIXITY_DECLARATION -> SETFIX ASSOCIATIVITY . INTEGER OP

    INTEGER         shift and go to state 7


state 4

    (26) ASSOCIATIVITY -> LEFTASSOC .

    INTEGER         reduce using rule 26 (ASSOCIATIVITY -> LEFTASSOC .)


state 5

    (27) ASSOCIATIVITY -> RIGHTASSOC .

    INTEGER         reduce using rule 27 (ASSOCIATIVITY -> RIGHTASSOC .)


state 6

    (28) ASSOCIATIVITY -> NONASSOC .

    INTEGER         reduce using rule 28 (ASSOCIATIVITY -> NONASSOC .)


state 7

    (25) FIXITY_DECLARATION -> SETFIX ASSOCIATIVITY INTEGER . OP
    (75) OP -> . VAROP
    (73) VAROP -> . VARSYM
    (74) VAROP -> . BACKTICK IDENTIFIER BACKTICK
    (78) VARSYM -> . PLUS
    (79) VARSYM -> . MINUS
    (80) VARSYM -> . TIMES
    (81) VARSYM -> . DIVIDE
    (82) VARSYM -> . MODULO
    (83) VARSYM -> . POW
    (84) VARSYM -> . EQUALITY
    (85) VARSYM -> . INEQUALITY
    (86) VARSYM -> . LESS
    (87) VARSYM -> . LEQ
    (88) VARSYM -> . GREATER
    (89) VARSYM -> . GEQ
    (90) VARSYM -> . AND
    (91) VARSYM -> . OR
    (92) VARSYM -> . LIST_CONSTRUCTOR

    BACKTICK        shift and go to state 11
    PLUS            shift and go to state 12
    MINUS           shift and go to state 13
    TIMES           shift and go to state 14
    DIVIDE          shift and go to state 15
    MODULO          shift and go to state 16
    POW             shift and go to state 17
    EQUALITY        shift and go to state 18
    INEQUALITY      shift and go to state 19
    LESS            shift and go to state 20
    LEQ             shift and go to state 21
    GREATER         shift and go to state 22
    GEQ             shift and go to state 23
    AND             shift and go to state 24
    OR              shift and go to state 25
    LIST_CONSTRUCTOR shift and go to state 26

    OP                             shift and go to state 8
    VAROP                          shift and go to state 9
    VARSYM                         shift and go to state 10

state 8

    (25) FIXITY_DECLARATION -> SETFIX ASSOCIATIVITY INTEGER OP .

    $end            reduce using rule 25 (FIXITY_DECLARATION -> SETFIX ASSOCIATIVITY INTEGER OP .)


state 9

    (75) OP -> VAROP .

    $end            reduce using rule 75 (OP -> VAROP .)


state 10

    (73) VAROP -> VARSYM .

    $end            reduce using rule 73 (VAROP -> VARSYM .)


state 11

    (74) VAROP -> BACKTICK . IDENTIFIER BACKTICK

    IDENTIFIER      shift and go to state 27


state 12

    (78) VARSYM -> PLUS .

    $end            reduce using rule 78 (VARSYM -> PLUS .)


state 13

    (79) VARSYM -> MINUS .

    $end            reduce using rule 79 (VARSYM -> MINUS .)


state 14

    (80) VARSYM -> TIMES .

    $end            reduce using rule 80 (VARSYM -> TIMES .)


state 15

    (81) VARSYM -> DIVIDE .

    $end            reduce using rule 81 (VARSYM -> DIVIDE .)


state 16

    (82) VARSYM -> MODULO .

    $end            reduce using rule 82 (VARSYM -> MODULO .)


state 17

    (83) VARSYM -> POW .

    $end            reduce using rule 83 (VARSYM -> POW .)


state 18

    (84) VARSYM -> EQUALITY .

    $end            reduce using rule 84 (VARSYM -> EQUALITY .)


state 19

    (85) VARSYM -> INEQUALITY .

    $end            reduce using rule 85 (VARSYM -> INEQUALITY .)


state 20

    (86) VARSYM -> LESS .

    $end            reduce using rule 86 (VARSYM -> LESS .)


state 21

    (87) VARSYM -> LEQ .

    $end            reduce using rule 87 (VARSYM -> LEQ .)


state 22

    (88) VARSYM -> GREATER .

    $end            reduce using rule 88 (VARSYM -> GREATER .)


state 23

    (89) VARSYM -> GEQ .

    $end            reduce using rule 89 (VARSYM -> GEQ .)


state 24

    (90) VARSYM -> AND .

    $end            reduce using rule 90 (VARSYM -> AND .)


state 25

    (91) VARSYM -> OR .

    $end            reduce using rule 91 (VARSYM -> OR .)


state 26

    (92) VARSYM -> LIST_CONSTRUCTOR .

    $end            reduce using rule 92 (VARSYM -> LIST_CONSTRUCTOR .)


state 27

    (74) VAROP -> BACKTICK IDENTIFIER . BACKTICK

    BACKTICK        shift and go to state 28


state 28

    (74) VAROP -> BACKTICK IDENTIFIER BACKTICK .

    $end            reduce using rule 74 (VAROP -> BACKTICK IDENTIFIER BACKTICK .)

